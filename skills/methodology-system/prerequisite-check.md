# Workflow Prerequisite Checking / å·¥ä½œæµå‰ç½®æ­¥é©Ÿæª¢æŸ¥

**Version**: 1.0.0
**Last Updated**: 2026-02-12

---

## Overview

This document defines how AI assistants should check prerequisites before executing slash commands. It ensures users follow recommended workflow sequences while preserving flexibility for experienced users.

æœ¬æ–‡ä»¶å®šç¾© AI åŠ©æ‰‹åœ¨åŸ·è¡Œæ–œç·šå‘½ä»¤å‰å¦‚ä½•æª¢æŸ¥å‰ç½®æ¢ä»¶ã€‚ç¢ºä¿ä½¿ç”¨è€…éµå¾ªå»ºè­°çš„å·¥ä½œæµåºåˆ—ï¼ŒåŒæ™‚ä¿ç•™è³‡æ·±ä½¿ç”¨è€…çš„å½ˆæ€§ã€‚

---

## Algorithm / æ¼”ç®—æ³•

When a slash command is invoked:

1. **Look up command** in `methodologies/workflow-prerequisites.yaml`
2. **If `entry_point: true`** â†’ Proceed immediately
   - If `recommended_prior` is defined â†’ Briefly mention recommended prior steps
3. **If `entry_point: false`** â†’ Check `requires_artifact`:
   a. Scan conversation context for evidence of artifact completion
   b. If artifact evidence found â†’ Proceed
   c. If artifact NOT found â†’ Prompt user with options
4. **Never block** â€” always offer "continue anyway" option

---

## Evidence Detection / è­‰æ“šåµæ¸¬

When checking for required artifacts, scan the current conversation for these signals:

| Artifact | Evidence Signals | è­‰æ“šä¿¡è™Ÿ |
|----------|-----------------|----------|
| `spec-approved` | SPEC-XXX.md mentioned with "approved" / "æ ¸å‡†" state; or user references an existing spec file | å°è©±ä¸­æåŠ SPEC æ–‡ä»¶ä¸”å·²æ ¸å‡† |
| `derived-tests` | `.feature` or `.test.ts` files recently generated by `/derive` | æœ€è¿‘ç”± /derive ç”¢ç”Ÿçš„æ¸¬è©¦æª”æ¡ˆ |
| `passing-tests` | Test run output with all passing | æ¸¬è©¦å…¨æ•¸é€šéçš„è¼¸å‡º |
| `discovery-report` | `/discover` output present in conversation | å°è©±ä¸­æœ‰ /discover çš„è¼¸å‡º |
| `reverse-spec` | `/reverse spec` output present in conversation | å°è©±ä¸­æœ‰ /reverse spec çš„è¼¸å‡º |
| `changelog-updated` | CHANGELOG.md modification mentioned or committed | å°è©±ä¸­æåŠ CHANGELOG.md å·²æ›´æ–° |
| `feature-files` | `.feature` files from `/bdd` in conversation | å°è©±ä¸­æœ‰ /bdd ç”¢ç”Ÿçš„ .feature æª”æ¡ˆ |
| `acceptance-criteria` | ATDD table or AC definitions in conversation | å°è©±ä¸­æœ‰ ATDD è¡¨æ ¼æˆ– AC å®šç¾© |
| `ideation-output` | `/brainstorm` output present in conversation | å°è©±ä¸­æœ‰ /brainstorm çš„è¼¸å‡º |
| `user-story` | User story with AC in conversation | å°è©±ä¸­æœ‰ä½¿ç”¨è€…æ•…äº‹å’Œ AC |

---

## User Prompt Templates / ä½¿ç”¨è€…æç¤ºæ¨¡æ¿

### Hard Prerequisites Not Met (requires_artifact)

**Chinese (Primary):**

```
âš ï¸ `/[command]` é€šå¸¸éœ€è¦å…ˆå®Œæˆä»¥ä¸‹æ­¥é©Ÿï¼š
- [ ] [prerequisite description]

æ‚¨æƒ³è¦ï¼š
1. å…ˆåŸ·è¡Œ `/[prerequisite-command]`ï¼ˆå»ºè­°ï¼‰
2. ç›´æ¥ç¹¼çºŒï¼ˆè·³éå‰ç½®æ­¥é©Ÿï¼‰
```

**English:**

```
âš ï¸ `/[command]` typically requires these prior steps:
- [ ] [prerequisite description]

Would you like to:
1. Run `/[prerequisite-command]` first (recommended)
2. Continue anyway (skip prerequisites)
```

### Soft Prerequisites (recommended_prior)

**Chinese (Primary):**

```
ğŸ’¡ å°æç¤ºï¼šåŸ·è¡Œ `/[recommended-command]` å¯ä»¥æä¾›æ›´å¥½çš„è„ˆçµ¡ã€‚
   ç¹¼çºŒåŸ·è¡Œ `/[command]`...
```

**English:**

```
ğŸ’¡ Tip: Running `/[recommended-command]` first can provide better context.
   Continuing with `/[command]`...
```

---

## Soft vs Hard Prerequisites / è»Ÿæ€§ vs ç¡¬æ€§å‰ç½®

| Type | Field | Behavior | Example |
|------|-------|----------|---------|
| **Hard** | `requires_artifact` | Cannot produce meaningful output without it; strong recommendation to complete first | `/derive` without approved SPEC |
| **Soft** | `recommended_prior` | Better results with it, but not required; brief mention, proceed by default | `/sdd` without `/discover` |

### Hard Prerequisite Examples

| Command | Missing Artifact | Prompt |
|---------|-----------------|--------|
| `/derive` | `spec-approved` | "âš ï¸ `/derive` éœ€è¦ä¸€ä»½å·²æ ¸å‡†çš„ SPEC æ–‡ä»¶ã€‚å»ºè­°å…ˆåŸ·è¡Œ `/sdd` å»ºç«‹è¦æ ¼ã€‚" |
| `/release` | `changelog-updated` | "âš ï¸ `/release` éœ€è¦å…ˆæ›´æ–° CHANGELOG.mdã€‚å»ºè­°å…ˆåŸ·è¡Œ `/release changelog`ã€‚" |
| `/bdd-review` | `derived-tests` | "âš ï¸ `/bdd-review` éœ€è¦å¾ `/derive` ç”¢ç”Ÿçš„æ¸¬è©¦æª”æ¡ˆã€‚" |

### Soft Prerequisite Examples

| Command | Recommended Prior | Prompt |
|---------|------------------|--------|
| `/sdd` | `discover` | "ğŸ’¡ å°æç¤ºï¼šå…ˆåŸ·è¡Œ `/discover` å¯ä»¥æä¾›å°ˆæ¡ˆè„ˆçµ¡ã€‚ç¹¼çºŒåŸ·è¡Œ `/sdd`..." |
| `/reverse` | `discover` | "ğŸ’¡ å°æç¤ºï¼šå…ˆåŸ·è¡Œ `/discover` å¯ä»¥äº†è§£å°ˆæ¡ˆå…¨è²Œã€‚ç¹¼çºŒåŸ·è¡Œ `/reverse`..." |
| `/refactor` | `discover` | "ğŸ’¡ å°æç¤ºï¼šå…ˆåŸ·è¡Œ `/discover` å¯ä»¥è­˜åˆ¥é‡æ§‹ç†±é»ã€‚ç¹¼çºŒåŸ·è¡Œ `/refactor`..." |

---

## Integration with Methodology Sessions / èˆ‡æ–¹æ³•è«–æœƒè©±çš„æ•´åˆ

- If user is in an **active methodology session** (e.g., TDD cycle), use the methodology's phase sequence as the primary prerequisite source
- If **no active methodology**, use `workflow-prerequisites.yaml` as fallback
- If **multiple workflows** contain the command, only ONE workflow needs to be satisfied

---

## Version History

| Version | Date | Changes |
|---------|------|---------|
| 1.0.0 | 2026-02-12 | Initial prerequisite checking specification |
