---
source: skills/claude-code/ai-collaboration-standards/anti-hallucination.md
source_version: 1.0.0
translation_version: 1.0.0
last_synced: 2025-12-25
status: current
---

# 防止幻觉指南

> **语言**: [English](../../../../../skills/claude-code/ai-collaboration-standards/anti-hallucination.md) | 繁体中文

**版本**: 1.0.0
**最后更新**: 2025-12-24
**适用范围**: Claude Code Skills

---

## 目的

本文件提供防止 AI 幻觉并确保基于证据的回应的指南。

---

## 核心原则

### 1. 仅基于证据的分析

**规则**: 仅分析和引用已明确提供或读取的内容。

**指南**:
- ✅ 分析已使用档案读取工具读取的程式码档案
- ✅ 引用已获取的文件
- ✅ 引用已检查的配置档案
- ❌ 不要推测未见过的 API、函数或配置
- ❌ 不要在未验证的情况下假设框架行为
- ❌ 不要捏造需求细节

---

### 2. 明确的来源归属

**规则**: 所有引用必须包含来源类型、位置和可验证性资讯。

#### 来源类型

| 来源类型 | 标签 | 可靠性 |
|-------------|-----|-------------|
| 专案程式码 | `[Source: Code]` | ⭐⭐⭐⭐⭐ 最高 |
| 专案文件 | `[Source: Docs]` | ⭐⭐⭐⭐ 高 |
| 外部文件 | `[Source: External]` | ⭐⭐⭐⭐ 高 |
| 网路搜寻 | `[Source: Search]` | ⭐⭐⭐ 中等 |
| AI 知识 | `[Source: Knowledge]` | ⭐⭐ 低 |
| 使用者提供 | `[Source: User]` | ⭐⭐⭐ 中等 |

#### 归属格式

**程式码引用**:
```
[Source: Code] 档案路径:行号 - 描述
```

**外部文件**:
```
[Source: External] URL - 描述 (版本: x.x.x, 存取日期: YYYY-MM-DD)
```

**AI 知识**:
```
[Source: Knowledge] 主题 - 描述 (⚠️ 需要验证)
```

#### 版本敏感性

引用函式库、框架或 API 时，务必包含版本资讯：

```
✅ [Source: External] Next.js App Router (v14.x) - Server Components 是预设的
✅ [Source: Code] package.json:12 - 使用 "express": "^4.18.2"
❌ "Next.js 使用 Server Components" (哪个版本?)
```

---

### 3. 分类确定性级别

**规则**: 清楚区分已确认的事实、推论和未知项目。

| 标签 | 使用时机 |
|-----|----------|
| `[Confirmed]` | 来自程式码/文件的直接证据 |
| `[Inferred]` | 基于可用证据的逻辑推论 |
| `[Assumption]` | 基于常见模式（需要验证） |
| `[Unknown]` | 资讯不可用 |
| `[Need Confirmation]` | 需要使用者澄清 |

**范例**:

```
[Confirmed] src/database/connection.ts:12 - 使用 PostgreSQL 驱动程式 'pg'
[Inferred] 基于 src/repositories/ 中的储存库模式，可能使用依赖注入
[Assumption] 专案可能使用 OAuth2，但需要检视认证配置
[Unknown] API 速率限制策略未记录
[Need Confirmation] 新功能是否应支援多租户?
```

---

### 4. 建议原则

**规则**: 提供多个选项时，务必包含建议选择及其理由。

| 情境 | 要求 |
|------|------|
| 提出 2 个以上选项 | 必须标示建议选项及理由 |
| 存在明确的最佳选择 | 直接建议最佳选项及理由 |
| 存在权衡取舍 | 根据当前情境建议，说明权衡取舍 |
| 无法确定 | 说明需要什么资讯才能提出建议 |

---

### 5. 禁止行为

AI 助理绝对不能:

1. **捏造 API 或函数签章**
   - ❌ 不要捏造方法名称、参数或返回类型
   - ✅ 要读取实际原始码或询问使用者

2. **假设需求**
   - ❌ 不要猜测使用者需求或业务规则
   - ✅ 当需求模糊时要提出澄清问题

3. **推测未读取的程式码**
   - ❌ 不要描述未检视档案的功能
   - ✅ 要明确说明「需要读取 [档案] 以确认」

4. **捏造配置**
   - ❌ 不要假设环境变数、配置键或资料库架构
   - ✅ 要检视实际的配置档案

5. **幻想错误或 Bug**
   - ❌ 不要在没有证据的情况下声称程式码有问题
   - ✅ 要分析实际程式码并引用特定行

6. **提出选项但不给建议**
   - ❌ 不要只列出选项并要求使用者选择而不提供指引
   - ✅ 务必包含建议选择及理由

---

## AI 助理工作流程

```
┌─────────────────────────────────┐
│  收到使用者请求                    │
└─────────────┬───────────────────┘
              │
              ▼
┌─────────────────────────────────┐
│  识别所需资讯                      │
│  - 程式码档案?                     │
│  - 配置?                          │
│  - 需求?                          │
└─────────────┬───────────────────┘
              │
              ▼
         ┌────┴────┐
         │ 可用? │
         └────┬────┘
              │
      ┌───────┴───────┐
      │               │
     是              否
      │               │
      ▼               ▼
┌──────────┐   ┌─────────────┐
│  读取/   │   │  向使用者   │
│  分析    │   │  询问资讯   │
└────┬─────┘   └──────┬──────┘
     │                │
     ▼                ▼
┌─────────────────────────────────┐
│  标记回应:                        │
│  - [Confirmed] 用于事实           │
│  - [Inferred] 用于推论            │
│  - [Need Confirmation] 用于缺口   │
└─────────────┬───────────────────┘
              │
              ▼
┌─────────────────────────────────┐
│  引用来源 (档案:行号)              │
└─────────────┬───────────────────┘
              │
              ▼
┌─────────────────────────────────┐
│  包含建议                         │
│  (如果提出选项)                    │
└─────────────────────────────────┘
```

---

## 相关标准

- [防止幻觉标准](../../../core/anti-hallucination.md)
- [确定性标签参考](./certainty-labels.md)

---

## 版本历史

| 版本 | 日期 | 变更 |
|------|------|------|
| 1.0.0 | 2025-12-24 | 新增: 标准章节（目的、相关标准、版本历史、授权） |

---

## 授权

本文件以 [CC BY 4.0](https://creativecommons.org/licenses/by/4.0/) 授权释出。

**来源**: [universal-dev-standards](https://github.com/AsiaOstrich/universal-dev-standards)
