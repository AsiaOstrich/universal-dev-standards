---
source: ../../../../skills/atdd-assistant/atdd-workflow.md
source_version: 1.0.0
translation_version: 1.0.0
last_synced: 2026-02-05
status: current
---

# ATDD 工作流程指南

**版本**: 1.0.0
**最后更新**: 2026-01-19

---

## ATDD 循环概览

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           ATDD 工作流程                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌──────────────┐    ┌──────────────┐    ┌──────────────┐                 │
│   │ 🤝 研讨会    │───▶│ 🧪 精炼      │───▶│ 💻 开发      │                 │
│   └──────────────┘    └──────────────┘    └──────────────┘                 │
│          │                                       │                          │
│          │                                       ▼                          │
│          │                               ┌──────────────┐                   │
│          │                               │ 🎬 演示      │                   │
│          │                               └──────────────┘                   │
│          │                                       │                          │
│          │            ┌──────────────┐           │                          │
│          └───────────▶│ ✅ 完成      │◀──────────┘                          │
│                       └──────────────┘                                      │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 阶段 1：规格研讨会

### 目的

协作定义「完成」的样貌，包含具体的验收标准。

### 时间

30-60 分钟

### 参与者

- 产品负责人（必要）
- 开发人员（必要）
- QA/测试人员（必要）
- 利益相关方（可选）

### 议程

| 时间 | 活动 | 主持 |
|------|------|------|
| 0-5 分钟 | 故事说明 | PO |
| 5-15 分钟 | 澄清问题 | 全员 |
| 15-35 分钟 | AC 定义 | 全员 |
| 35-45 分钟 | 范围外 | 全员 |
| 45-55 分钟 | 技术备注 | Dev |
| 55-60 分钟 | 总结 | 全员 |

### 研讨会流程

```
┌─────────────────────────────────────────────────────────────────┐
│              规格研讨会流程                                       │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. 故事说明 (5 分钟)                                            │
│     └─▶ PO 解释用户故事、商业价值、背景                          │
│                                                                 │
│  2. 澄清问题 (10 分钟)                                           │
│     ├─▶ 商业：「价值是什么？」「优先级？」                       │
│     ├─▶ Dev：「影响？」「依赖？」「性能？」                      │
│     └─▶ QA：「可能出什么错？」「边界案例？」                     │
│                                                                 │
│  3. 验收标准定义 (20 分钟)                                       │
│     ├─▶ 定义 happy path AC                                      │
│     ├─▶ 定义错误/边界案例 AC                                    │
│     └─▶ 使用 Given-When-Then 格式                               │
│                                                                 │
│  4. 范围外 (10 分钟)                                             │
│     └─▶ 明确列出不包含的内容                                    │
│                                                                 │
│  5. 技术备注 (5 分钟)                                            │
│     └─▶ 实现提示、限制、依赖                                    │
│                                                                 │
│  6. 总结 (5 分钟)                                                │
│     ├─▶ 审查所有 AC                                             │
│     ├─▶ 确认 PO 理解                                            │
│     └─▶ 安排精炼会议                                            │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 各角色问题

| 角色 | 焦点 | 问题 |
|------|------|------|
| **商业** | What & Why | 商业价值是什么？用户是谁？这解决什么问题？优先级？ |
| **开发** | How | 影响哪些系统？有依赖吗？性能考量？现有数据影响？ |
| **测试** | What if | 可能出什么错？边界案例是什么？如何验证成功？安全考量？ |

### 输出模板

```markdown
## 用户故事: [US-XXX] [标题]

**研讨会日期**: [日期]
**参与者**: [姓名]

**作为** [角色]
**我想要** [功能]
**以便** [好处]

## 验收标准

### AC-1: [Happy path 描述]
**Given** [前置条件]
**When** [动作]
**Then** [预期结果]

### AC-2: [错误情境]
**Given** [前置条件]
**When** [无效动作]
**Then** [错误处理]

### AC-3: [边界案例]
**Given** [边界条件]
**When** [动作]
**Then** [适当结果]

## 范围外
- [功能 1 - 延后至未来 Sprint]
- [功能 2 - MVP 之外]

## 技术备注
- [限制 1]
- [依赖信息]
- [性能需求]

## 开放问题
- [ ] [问题 1 - 指派给: @person]
- [ ] [问题 2 - 需要 PO 澄清]
```

### 检查清单

```
□ 产品负责人出席
□ 开发人员出席
□ QA/测试人员出席
□ 用户故事已说明商业价值
□ 所有澄清问题已回答（或记录）
□ 验收标准使用 Given-When-Then 格式
□ Happy path 已涵盖
□ 错误情境已涵盖
□ 边界案例已涵盖
□ 范围外已明确记录
□ 技术备注已添加
□ 所有参与者同意范围
```

---

## 阶段 2：精炼

### 目的

将验收标准转换为可执行、可自动化的测试。

### 时间

30-60 分钟

### 参与者

- 开发人员（必要）
- QA/测试人员（必要）
- 产品负责人（签核）

### 步骤

```
┌─────────────────────────────────────────────────────────────────┐
│              精炼流程                                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. 审查验收标准                                                 │
│     对于每个 AC：                                                │
│     □ 是否明确无歧义？                                          │
│     □ 可以自动化吗？                                            │
│     □ 是否验证商业价值？                                        │
│     → 精炼任何不清楚的标准                                      │
│                                                                 │
│  2. 选择测试格式                                                 │
│     │                                                           │
│     ├─ Gherkin → Cucumber, SpecFlow, Behave                     │
│     ├─ Wiki 表格 → FitNesse, Slim                               │
│     ├─ 关键字 → Robot Framework                                 │
│     └─ 代码 → xUnit 使用描述性名称                              │
│                                                                 │
│  3. 撰写可执行测试                                               │
│     │                                                           │
│     ├─ 每个验收标准一个测试                                     │
│     ├─ 包含 setup/teardown                                      │
│     └─ 确保测试独立                                             │
│                                                                 │
│  4. PO 签核                                                      │
│     │                                                           │
│     ├─ PO 审查测试规格                                          │
│     ├─ 确认测试代表需求                                         │
│     └─ 开发开始前签核                                           │
│                                                                 │
│  5. 执行测试（应该失败）                                         │
│     │                                                           │
│     └─ 所有测试初始失败（RED 状态）                             │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 测试格式比较

| 格式 | 工具示例 | 商业可读性 | 最适合 |
|------|---------|----------|--------|
| **Gherkin** | Cucumber, SpecFlow | ★★★★★ | 行为情境 |
| **Wiki 表格** | FitNesse | ★★★★☆ | 数据驱动测试 |
| **关键字** | Robot Framework | ★★★★☆ | 复杂工作流程 |
| **代码** | xUnit, pytest | ★★☆☆☆ | 技术团队 |

### Gherkin 示例

```gherkin
# 文件: features/password-reset.feature
# 故事: US-123 - 密码重设

@US-123
Feature: 密码重设
  作为注册用户
  我想要通过电子邮件重设密码
  以便我忘记密码时能重新访问

  @AC-1 @happy-path
  Scenario: 请求密码重设
    Given 我在登录页面
    And 我有一个电子邮件为 "user@example.com" 的注册账号
    When 我点击「忘记密码」
    And 我输入我的电子邮件 "user@example.com"
    Then 我应该看到「重设链接已发送至您的电子邮件」
    And 我应该在 5 分钟内收到电子邮件

  @AC-2 @error-handling
  Scenario: 重设链接 24 小时后过期
    Given 我已请求密码重设
    When 我在 24 小时后点击重设链接
    Then 我应该看到「此链接已过期」
    And 我应该可以请求新的链接

  @AC-3 @security
  Scenario: 未注册电子邮件显示通用消息
    Given 我在密码重设页面
    When 我输入未注册的电子邮件
    Then 我应该看到「重设链接已发送至您的电子邮件」
    But 实际上不应该发送电子邮件
```

### 检查清单

```
□ 所有 AC 已审查清晰度
□ 模糊的标准已澄清
□ 测试格式已选择
□ 所有 AC 已撰写可执行测试
□ 测试是独立的
□ PO 已审查并签核
□ 测试执行并失败（RED）
```

---

## 阶段 3：开发

### 目的

由验收测试驱动，实现功能。

### 时间

可变（取决于复杂度）

### 参与者

- 开发人员（主要）
- QA/测试人员（支持）

### 开发流程

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        ATDD 开发流程                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   验收测试（RED - 全部失败）                                                 │
│        │                                                                    │
│        ▼                                                                    │
│   ┌─────────────────────────────────────────┐                               │
│   │ 对于每个验收测试：                       │                               │
│   │                                         │                               │
│   │   1. 识别需要的组件                     │                               │
│   │        │                                │                               │
│   │        ▼                                │                               │
│   │   ┌─────────────────────────────┐       │                               │
│   │   │ TDD 循环（对于每个单元）     │       │                               │
│   │   │  🔴 撰写失败的单元测试      │       │                               │
│   │   │  🟢 实现最小代码            │       │                               │
│   │   │  🔵 重构                    │       │                               │
│   │   └─────────────┬───────────────┘       │                               │
│   │                 │                       │                               │
│   │                 ▼                       │                               │
│   │   执行验收测试                          │                               │
│   │        │                                │                               │
│   │        ├─ 仍然失败？→ 更多 TDD          │                               │
│   │        │                                │                               │
│   │        └─ 通过？→ 下一个 AT             │                               │
│   │                                         │                               │
│   └─────────────────────────────────────────┘                               │
│        │                                                                    │
│        ▼                                                                    │
│   所有验收测试（GREEN - 全部通过）                                           │
│        │                                                                    │
│        ▼                                                                    │
│   重构（保持测试绿灯）                                                       │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### ATDD + BDD + TDD 整合

```
层级               焦点                   参与者
─────              ─────                   ────────────
ATDD               验收标准               PO + Dev + QA
  │                （什么是完成？）
  │
  ▼
BDD                行为情境               Dev + QA + BA
  │                （如何运作？）
  │
  ▼
TDD                单元实现               开发人员
                   （怎么实现？）
```

### 检查清单

```
□ 验收测试初始失败（RED）
□ BDD 情境已撰写
□ TDD 用于单元实现
□ 逐步进展被追踪
□ 所有验收测试通过（GREEN）
□ 代码重构且整洁
□ 代码已审查
□ 准备演示
```

---

## 阶段 4：演示

### 目的

向利益相关方展示完成的功能并获得正式验收。

### 时间

15-30 分钟

### 参与者

- 产品负责人（必要）
- 开发人员（必要）
- QA/测试人员（必要）
- 利益相关方（视需要）

### 演示结构

| 时间 | 活动 | 主持 |
|------|------|------|
| 0-1 分钟 | 背景 | Dev |
| 1-3 分钟 | 展示测试 | QA |
| 3-13 分钟 | 功能演示 | Dev |
| 13-20 分钟 | 反馈与问答 | PO |
| 20-25 分钟 | 决策 | PO |

### 演示流程

```
┌─────────────────────────────────────────────────────────────────┐
│                        演示结构                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. 背景 (1 分钟)                                                │
│     ├─ 提醒利益相关方用户故事                                   │
│     └─ 展示验收标准                                             │
│                                                                 │
│  2. 展示测试 (2 分钟)                                            │
│     ├─ 现场执行验收测试                                         │
│     └─ 展示全部通过                                             │
│                                                                 │
│  3. 功能演示 (5-10 分钟)                                         │
│     ├─ 逐一展示每个验收标准                                     │
│     ├─ 展示运作中的功能                                         │
│     └─ 展示已测试的边界案例                                     │
│                                                                 │
│  4. 反馈与问答 (5 分钟)                                          │
│     ├─ 收集反馈                                                 │
│     ├─ 澄清任何问题                                             │
│     └─ 记录任何新需求                                           │
│                                                                 │
│  5. 决策 (5 分钟)                                                │
│     │                                                           │
│     ├─ ✅ 接受                                                  │
│     │     故事完成，准备合并                                    │
│     │                                                           │
│     ├─ 🔄 需要精炼                                              │
│     │     带着新学习返回研讨会                                  │
│     │                                                           │
│     └─ ❌ 未接受                                                │
│           识别差距，迭代                                        │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 检查清单

```
□ 演示环境已准备
□ 测试数据就绪
□ 所有验收测试通过
□ 利益相关方已通知并出席
□ 演示成功完成
□ PO 决策已记录
□ 后续步骤已记录
```

---

## 阶段 5：完成

### 完成的定义

```
□ 所有验收测试通过
□ 产品负责人已接受
□ 代码已审查并核准
□ 代码已合并至主分支
□ 文档已更新
□ 准备发布
```

### 验收后

1. **合并代码**至主分支
2. **更新文档**（如需要）
3. **关闭故事**在追踪系统中
4. **分享学习**给团队
5. **规划下一个故事**

---

## 相关资源

- [验收标准撰写指南](./acceptance-criteria-guide.md)
- [ATDD 核心标准](../../../../core/acceptance-test-driven-development.md)
- [BDD 工作流程](../bdd-assistant/bdd-workflow.md)
- [TDD 工作流程](../tdd-assistant/tdd-workflow.md)
