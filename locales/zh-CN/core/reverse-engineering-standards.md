---
source: ../../core/reverse-engineering-standards.md
source_version: 1.0.0
translation_version: 1.0.0
last_synced: 2026-01-19
status: current
---

# 反向工程标准

**版本**: 1.0.0
**最后更新**: 2026-01-19
**适用范围**: 所有需要将程序码转换为规格文件的专案

> **语言**: [English](../../core/reverse-engineering-standards.md) | [繁体中文](../../zh-TW/core/reverse-engineering-standards.md)

---

## 目的

本标准定义将现有程序码反向工程为结构化规格文件的原则、工作流程和最佳实践。反向工程是连接旧有系统与现代开发方法论（SDD → BDD → TDD）的桥梁。

**主要效益**：
- 将未文件化的程序码转换为可追溯的规格
- 在旧有系统上启用现代开发实践
- 在新团队成员与现有程序码库之间建立共同理解
- 为未来增强和重构建立基础

---

## 反向工程工作流程

```
┌──────────────────────────────────────────────────────────────────────────┐
│                         反向工程工作流程                                   │
├──────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌───────────┐  │
│  │  程序码扫描  │───▶│  测试分析   │───▶│  缺口识别   │───▶│  规格生成  │  │
│  └─────────────┘    └─────────────┘    └─────────────┘    └───────────┘  │
│        │                  │                  │                  │        │
│        │                  │                  │                  ▼        │
│        │                  │                  │         ┌───────────────┐ │
│        │                  │                  │         │   人类审查    │ │
│        │                  │                  │         └───────────────┘ │
│        │                  │                  │                  │        │
│        ▼                  ▼                  ▼                  ▼        │
│    [已确认]            [已确认]            [未知]            [已验证]      │
│    来自程序码          来自测试           需人类输入          规格文件     │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘
```

### 工作流程阶段

| 阶段 | 说明 | 产出物 | 确定性层级 |
|------|------|--------|-----------|
| **程序码扫描** | 分析程序码结构、API、资料模型 | 技术清单 | [已确认] |
| **测试分析** | 解析现有测试以取得验收条件 | 草拟验收条件 | [已确认]/[推论] |
| **缺口识别** | 列出需要人类输入的未知项目 | 缺口分析文件 | [未知] 项目 |
| **规格生成** | 生成草拟规格 | 草拟 SPEC-XXX.md | 混合确定性 |
| **人类审查** | 利害关系人验证与填补缺口 | 已验证的规格 | [已确认] |

---

## 核心原则

### 1. 确定性框架

所有提取的资讯必须标注确定性层级：

| 标签 | 定义 | 范例 |
|------|------|------|
| `[已确认]` | 直接从程序码或测试验证 | "POST /api/users 端点位于 src/routes/users.ts:15" |
| `[推论]` | 从观察到的模式进行逻辑推导 | "根据建构子模式，可能使用依赖注入" |
| `[假设]` | 需要验证的合理假设 | "根据典型模式，session 可能在 24 小时后过期" |
| `[未知]` | 无法从程序码判断，需要人类输入 | "此功能的商业动机" |

**规则**：有疑问时，使用更不确定的标签，而非过度声称。

### 2. 反幻觉合规

本标准严格遵循[反幻觉标准](anti-hallucination.md)：

- **基于证据**：仅分析已明确读取的内容
- **来源归属**：每项声明必须包含 `[来源: 程序码]` 或 `[来源: 测试]` 并附上 file:line 参考
- **禁止捏造**：未经验证不得编造 API、配置或需求
- **明确未知**：始终列出无法从程序码判断的项目

### 3. 渐进式揭露

分层提取资讯：

1. **系统概览**：入口点、主要元件、高层架构
2. **元件详情**：各模组、其职责、介面
3. **实作细节**：演算法、资料流、边界情况

### 4. 测试对需求映射

现有测试是�的含需求的宝贵来源：

```javascript
// 测试：src/tests/auth.test.ts
describe('Authentication', () => {
  it('should return 401 for invalid credentials', () => {...});
  it('should issue JWT token on successful login', () => {...});
});
```

映射为：

```markdown
## 验收条件
[已确认] 来自测试分析 (src/tests/auth.test.ts)：
- [ ] 对无效凭证回传 401 状态码 (第 3 行)
- [ ] 登入成功时核发 JWT token (第 4 行)
```

---

## 可提取与不可提取的内容

### 可提取（AI 自动化）

| 面向 | 确定性 | 来源 |
|------|--------|------|
| API 端点 | [已确认] | 路由定义、控制器 |
| 资料模型 | [已确认] | 型别、介面、Schema |
| 函数签名 | [已确认] | 参数、回传型别 |
| 测试案例 | [已确认] | 测试档案 → 验收条件 |
| 相依性 | [已确认] | 套件引用、汇入 |
| 配置模式 | [已确认] | 配置档案 |
| 行为模式 | [推论] | 程序码分析 |

### 不可提取（需要人类输入）

| 面向 | 原因 | 必要行动 |
|------|------|---------|
| **动机/为什么** | 历史�的络不在程序码中 | 询问利害关系人 |
| **商业背景** | 领域知识 | 询问产品负责人 |
| **风险评估** | 需要领域专家 | 咨询领域专家 |
| **取舍决策** | 缺少历史脉络 | 检视设计文件（如有） |
| **非功能性需求** | 通常是隐含的 | 与架构师讨论 |
| **范围外决策** | 被明确排除的项目 | 检视原始需求 |

---

## 与开发方法论整合

### 反向工程流水线

```
┌───────────────────────────────────────────────────────────────────────┐
│                    反向工程 → 前向开发                                  │
├───────────────────────────────────────────────────────────────────────┤
│                                                                       │
│   现有                                                                │
│   程序码 + 测试                                                        │
│       │                                                               │
│       ▼                                                               │
│   ┌─────────────────────────────────────────────────────────────┐    │
│   │ 反向工程（本标准）                                            │    │
│   │   • 程序码扫描 → 技术清单                                     │    │
│   │   • 测试分析 → 验收条件                                       │    │
│   │   • 缺口识别 → [未知] 清单                                    │    │
│   └─────────────────────────────────────────────────────────────┘    │
│       │                                                               │
│       ▼                                                               │
│   ┌─────────────────────────────────────────────────────────────┐    │
│   │ SDD（规格驱动开发）                                           │    │
│   │   • 反向工程规格 = 提案草稿                                   │    │
│   │   • 填写 [未知] 区块 → 完整提案                               │    │
│   │   • 正式审查 → 已核准规格                                     │    │
│   └─────────────────────────────────────────────────────────────┘    │
│       │                                                               │
│       ▼                                                               │
│   ┌─────────────────────────────────────────────────────────────┐    │
│   │ BDD（行为驱动开发）                                           │    │
│   │   • 验收条件 → Gherkin 情境                                   │    │
│   │   • 利害关系人验证                                            │    │
│   └─────────────────────────────────────────────────────────────┘    │
│       │                                                               │
│       ▼                                                               │
│   ┌─────────────────────────────────────────────────────────────┐    │
│   │ TDD（测试驱动开发）                                           │    │
│   │   • Gherkin → 单元测试需求                                    │    │
│   │   • 缺口分析 → 缺少的测试覆盖                                 │    │
│   └─────────────────────────────────────────────────────────────┘    │
│                                                                       │
└───────────────────────────────────────────────────────────────────────┘
```

### SDD 整合

反向工程的规格直接进入 SDD 工作流程：

1. **产出 = SDD 提案草稿**：生成的规格成为提案
2. **需要人类审查**：所有 `[未知]` 区块必须由人类填写
3. **正式核准**：规格必须经过标准 SDD 审查流程
4. **状态追踪**：在规格元资料中标记为「反向工程」

---

## 工具整合

### 命令列工具

| 工具 | 命令 | 用途 |
|------|------|------|
| **Claude Code** | `/reverse-spec` | 从程序码生成 SDD 规格 |
| **Claude Code** | `/reverse-bdd` | 将 AC 转换为 Gherkin 情境 |
| **Claude Code** | `/reverse-tdd` | 分析 BDD 的测试覆盖 |

### 技能参考

- [反向工程技能](../../skills/reverse-engineer/SKILL.md) - 详细工作流程实作
- [规格驱动开发技能](../../skills/spec-driven-dev/SKILL.md) - SDD 整合
- [BDD 助手技能](../../skills/bdd-assistant/SKILL.md) - Gherkin 撰写
- [TDD 助手技能](../../skills/tdd-assistant/SKILL.md) - 测试覆盖分析

---

## 相关标准

- [反幻觉指南](anti-hallucination.md) - 基于证据的分析要求
- [规格驱动开发](spec-driven-development.md) - 规格工作流程
- [行为驱动开发](behavior-driven-development.md) - Given-When-Then 情境
- [测试驱动开发](test-driven-development.md) - 红-绿-重构循环
- [验收测试驱动开发](acceptance-test-driven-development.md) - 验收条件
- [程序码审查清单](code-review-checklist.md) - 审查指南

---

## 版本历史

| 版本 | 日期 | 变更内容 |
|------|------|----------|
| 1.0.0 | 2026-01-19 | 初始发布 |

---

## 参考资料

- [反幻觉标准](anti-hallucination.md) - 核心合规要求
- [IEEE 830-1998 - 软体需求规格](https://standards.ieee.org/ieee/830/1222/)
- [SWEBOK v4.0 - 第 9 章：软体维护](https://www.computer.org/education/bodies-of-knowledge/software-engineering)
- [与旧有程序码有效协作 - Michael Feathers](https://www.oreilly.com/library/view/working-effectively-with/0131177052/)

---

## 授权

本标准以 [CC BY 4.0](https://creativecommons.org/licenses/by/4.0/) 授权发布。
